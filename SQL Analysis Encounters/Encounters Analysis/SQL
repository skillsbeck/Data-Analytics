--total cost of encounters per patient
SELECT
    p.id,
    p.first,
    p.last,
    SUM(e.total_claim_cost) AS total_encounter_cost
FROM
    Patients p
JOIN
    Encounters e
ON
    p.id = e.patient
GROUP BY
    p.id,
    p.first,
    p.last;
